# The aed-schism.xdiff file should be applied from the AED_Tools directory
#
# This diff patches :
#
#       schism/src/CMakeLists.txt             - add the AED target
#
#       schism/src/Core/schism_glbl.F90       - bump the # of available tracers to allow for aed
#
#       schism/src/Core/scribe_io.F90         - add calls for scribe_write of aed
#       schism/src/Hydro/schism_finalize.F90  - add a call for aed_finalise
#       schism/src/Hydro/schism_init.F90      - add call for aed_initialisation, scribe writing initialisation etc
#       schism/src/Hydro/schism_step.F90      - add calls to do_aed, scribe write aed writing diag vars
#
#       schism/src/Utility/Combining_Scripts/CMakeLists.txt  - add a target for aed
#       schism/src/Utility/Combining_Scripts/combine_output11.f90      - support for aed stuff
#       schism/src/Utility/Combining_Scripts/combine_output11_MPI.F90  - support for aed stuff
#
# schism_glbl.F90 patches the number of available tracers from 12 to 13 to support AED.
# The other 3 source patches add calls so the aed for initialisation, execution, and cleanup.
# These patches are bounded by #ifdef USE_AED ... #endif statements the USE_AED symbol 
# is exported by the make system
#
# Other changes to the schism source tree are made from the build_schism.sh file which patches
# cmake input files to turn on/off modules (in our case set USE_AED to ON).
#
#                          -------------------------------
#
# The main AED stuff then lives in src/AED/ which has two files (for now) :
#
#            CMakeLists.txt.m   and   schism_aed.F90
#
# CMakeLists.txt.m is modified by the build script to correct the paths listed in it, writing
# the modified file to CMakeLists.txt for the cmake system to use.
#  [it turned out the gnu-make files were worse than the cmake files  a bit disappointing]
#
# schism_aed.F90 contains :
#
#   schism_aed_init_model(ntracers=ntrs(13))
#     At this stage most variables are not yet set - so we dont know, for example, how many 
#     columns there are, nor how many layers.  This is a good place to read the aed.nml file
#     to set global configuration values
#
#   schism_aed_init_stage2()
#     So now we have ne (or nea) for the number of column, and, presumably a bunch of
#     other useful bits so we can build arrays etc.
#
#   schism_aed_do()
#     The main doing stuff routine - currently doesnt seem to get called, but thats
#     kind of OK because it still needs a fair bit of work, and until the init stage
#     works properly...
#
#   schism_aed_write_output_netcdf(time=time)
#   schism_aed_close_output_netcdf()
#
# The current iteration of this file uses the libaed-api which is the simplified
# interface to the aed libraries.
#
